// 首頁唯一入口：密碼 → 章節 ID
const PASSWORD_TO_ID = {
  "開始":"Basic",
  "案發現場":"Case",
  "死亡訊息":"Cash",
  "遺失的拼圖":"Chat",
  "真正的凶手":"Criminal",
  "真相":"Truth"
};

// 章節表
const SECTION_MAP = {
  Basic:{
    id:"Basic", title:"Basic",
    steps:[
      { type:"narrative", text:
`沒想到，這個測驗還真的有人做啊。
「解謎者」是嗎？
好吧，那就讓我來考考你吧，解謎者。
在剛剛的「解謎者」的結果頁面中，藏了一段訊息。
你能告訴我是什麼嗎？` },
      // 回答1：一句話＋空格
      { type:"answer",
        fields:{
          a1:{ kind:"text", size:"wide", accept:["測驗的布幕後是一條逝去的生命"] }
        },
        rows:[
          { parts:[ {field:"a1"}] }
        ]
      },
      { type:"narrative", text:
`逝去的生命嗎？
確實如此呢。
既然這樣，親愛的解謎者。
我手上有一個詭異的案件。
如果你認為你有能力解開這個謎團。
那就留意一下你的信箱吧。` },
      { type:"ending", text:"請打開信封A" }
    ]
  },

  Case:{
    id:"Case", title:"Case",
    steps:[
      { type:"narrative", text:
`說真的，我沒有預期你還會聯絡我。
不過既然你都來找我了，代表一定有所發現吧？
那告訴我吧，解謎者，
在5位證人中，你認為誰在說謊呢？` },
      { type:"answer",
        fields:{
          who:{ kind:"select", options:["何文禮","郭榮泰","莊曉純","林孟君","黃素娥"], accept:["郭榮泰"] }
        },
        rows:[
          { parts:[{field:"who"}," 在說謊。"] }
        ]
      },
      { type:"narrative", text:
`你說那個房東？
好吧，那請你告訴我，你這麼說的依據是什麼？` },
      { type:"answer",
        fields:{
          evA:{ kind:"select", options:["心理測驗","心理測驗結果","何文禮的證詞","郭榮泰的證詞","莊曉純的證詞","林孟君的證詞","黃素娥的證詞","案發現場照片","桌面照片","死者手部照片","死者和前女友的合照","現場報告","解剖紀錄","報紙"], accept:[] },
          evB:{ kind:"select", options:["心理測驗","心理測驗結果","何文禮的證詞","郭榮泰的證詞","莊曉純的證詞","林孟君的證詞","黃素娥的證詞","案發現場照片","桌面照片","死者手部照片","死者和前女友的合照","現場報告","解剖紀錄","報紙"], accept:[] },
          x1 :{ kind:"select", options:["看到死者前女友","接到電話","開車出門","抵達現場","接受偵訊"], accept:"抵達現場" },
          x2 :{ kind:"select", options:["早","晚","剛好"], accept:"早" }
        },
        rows:[
          { parts:["根據 ",{field:"evA"}," 和 ",{field:"evB"},"，郭榮泰 ",{field:"x1"}," 的時間太 ",{field:"x2"}," 了。"] }
        ],
        orderInsensitivePairs:[{ a:"evA", b:"evB", accept:[["林孟君的證詞","郭榮泰的證詞"]] }]
      },
      { type:"narrative", text:
`原來如此。
根據林孟君的說法，平等路是六角區往海迪區最快的道路，繞路的話就要多花十幾分鐘。住在六角區的郭榮泰前往案發現場只花了20分鐘，但當時平等路已經因為施工封閉了，他根本不可能那麼快就抵達。
換句話說，他在說謊。
做的好，解謎者。
如果有什麼案情有什麼進展，我會再聯絡你的。` },
      { type:"ending", text:"請打開信封B" }
    ]
  },

  Cash:{
    id:"Cash", title:"Cash",
    steps:[
      { type:"narrative", text:
`沒想到你這麼快就解出來了。
那告訴我吧，張大智留下的死亡訊息，究竟是什麼意思？` },
      { type:"answer",
        fields:{
          t1:{ kind:"select", options:["密碼","縮寫","姓名","圖案","單字"], accept:"圖案" },
          t2:{ kind:"text", accept:["哈卡克"] },
          t4:{ kind:"select", options:["心理測驗","心理測驗結果","何文禮的證詞","郭榮泰的證詞","莊曉純的證詞","林孟君的證詞","黃素娥的證詞","案發現場照片","桌面照片","死者手部照片","死者和前女友的合照","現場報告","解剖紀錄","報紙","鈔票照片","發票照片","手機支架照片","房東新的證詞","死者銀行紀錄"], accept:"報紙" },
        },
        rows:[
          { parts:["張大智手上的死亡訊息，其實是一個 ",{field:"t1"},"，根據",{field:"t4"} ,"，他的名字是 ",{field:"t2"},"。"] }
      ]},
      { type:"narrative", text:
`哈卡克？
我好像還有在哪裡聽過這個詞彙。` },
      { type:"answer",
        fields:{
          t3:{ kind:"select", options:["心理測驗","心理測驗結果","何文禮的證詞","郭榮泰的證詞","莊曉純的證詞","林孟君的證詞","黃素娥的證詞","案發現場照片","桌面照片","死者手部照片","死者和前女友的合照","現場報告","解剖紀錄","報紙","鈔票照片","發票照片","手機支架照片","房東新的證詞","死者銀行紀錄"], accept:"心理測驗" }
        },
        rows:[
          { parts:["在 ",{field:"t3"}," 也有出現過。"] }
        ]
      },
      { type:"narrative", text:
`沒錯。
哈卡克心理測驗。
原來那個訊息是這個意思啊。
我馬上請人去調查，有什麼資訊再寄信給你。` },
      { type:"ending", text:"請打開信封C" }
    ]
  },

  Chat:{
    id:"Chat", title:"Chat",
    steps:[
      { type:"narrative", text:
`結果怎麼樣？
你覺得張大智是單純的自殺，還是被人殺害的？` },
      { type:"answer",
        fields:{
          e1:{ kind:"select", options:["心理測驗","心理測驗結果","何文禮的證詞","郭榮泰的證詞","莊曉純的證詞","林孟君的證詞","黃素娥的證詞","案發現場照片","桌面照片","死者手部照片","死者和前女友的合照","現場報告","解剖紀錄","報紙","鈔票照片","發票照片","手機支架照片","房東新的證詞","死者銀行紀錄","心理測驗原稿","回饋單1","回饋單2","回饋單3","回饋單4","回饋單5","林孟君聊天紀錄","何文禮聊天紀錄","郭榮泰聊天紀錄","莊曉純聊天紀錄"], accept:"林孟君聊天紀錄" },
          e2:{ kind:"select", options:["自殺","他殺"], accept:"他殺" }
        },
        rows:[ { parts:["根據 ",{field:"e1"},"，張大智應該是 ",{field:"e2"},"。"] } ]
      },
      { type:"narrative", text:
`沒想到你真的成功解開了他的聊天紀錄。
沒錯，他傳訊息給林孟君的時間，和法醫估計的死亡時間差不多。
看他的回覆，不像是馬上要去自殺的樣子。
換句話說，這是一起謀殺案。
你知道凶手是誰了嗎？` },
      { type:"answer",
        fields:{
          f1:{ kind:"text",  accept:"何文禮" },
          f2:{ kind:"select", options:["心理測驗","心理測驗結果","何文禮的證詞","郭榮泰的證詞","莊曉純的證詞","林孟君的證詞","黃素娥的證詞","案發現場照片","桌面照片","死者手部照片","死者和前女友的合照","現場報告","解剖紀錄","報紙","鈔票照片","發票照片","手機支架照片","房東新的證詞","死者銀行紀錄","心理測驗原稿","回饋單1","回饋單2","回饋單3","回饋單4","回饋單5","林孟君聊天紀錄","何文禮聊天紀錄","郭榮泰聊天紀錄","莊曉純聊天紀錄"], accept:"何文禮聊天紀錄" },
          f3:{ kind:"select", options:["金錢","理想","感情","復仇","意外"], accept:"金錢" }
        },
        rows:[
          { parts:["凶手是 ",{field:"f1"},"，從 ",{field:"f2"}," 可以得知，他的犯案動機應該是 ",{field:"f3"},"。"] }
        ]
      },
      { type:"narrative", text:
`沒錯。這麼一來，張大智的銀行紀錄就說得通了。
他沒有向銀行貸款，而是跟何文禮借了一堆錢，最終還不出來，引發了殺機。
哼，沒想到大學最要好的兩個人，最後竟然為了錢反目成仇，真是老套到令人噁心的劇情。
這麼一來，案件也差不多該結束了吧。
合作愉快，解謎者。` },
      { type:"ending", text:"請打開信封D" }
    ]
  },

  Criminal:{
    id:"Criminal", title:"Criminal",
    steps:[
      { type:"narrative", text:
`僅憑一份新的證詞，你就知道真正的凶手是誰了嗎？
好吧，解謎者。
就請你告訴我，我究竟漏掉了什麼？` },
      { type:"answer",
        fields:{
          gA:{ kind:"select", options:["心理測驗","心理測驗結果","何文禮的證詞","郭榮泰的證詞","莊曉純的證詞","林孟君的證詞","黃素娥的證詞","案發現場照片","桌面照片","死者手部照片","死者和前女友的合照","現場報告","解剖紀錄","報紙","鈔票照片","發票照片","手機支架照片","房東的新證詞","死者銀行紀錄","心理測驗原稿","回饋單1","回饋單2","回饋單3","回饋單4","回饋單5","林孟君聊天紀錄","何文禮聊天紀錄","郭榮泰聊天紀錄","莊曉純聊天紀錄","何文禮的新證詞","社團廣告單"], accept:[] },
          gB:{ kind:"select", options:["心理測驗","心理測驗結果","何文禮的證詞","郭榮泰的證詞","莊曉純的證詞","林孟君的證詞","黃素娥的證詞","案發現場照片","桌面照片","死者手部照片","死者和前女友的合照","現場報告","解剖紀錄","報紙","鈔票照片","發票照片","手機支架照片","房東的新證詞","死者銀行紀錄","心理測驗原稿","回饋單1","回饋單2","回饋單3","回饋單4","回饋單5","林孟君聊天紀錄","何文禮聊天紀錄","郭榮泰聊天紀錄","莊曉純聊天紀錄","何文禮的新證詞","社團廣告單"], accept:[] },
          gC:{ kind:"select", options:["張大智","何文禮","郭榮泰","莊曉純","林孟君","黃素娥",], accept:["何文禮"] },
          gD:{ kind:"text",  accept:["老婆","伴侶","太太","夫人","配偶","妻子"] }
        },
        rows:[
          { parts:["根據 ",{field:"gA"}," 和 ",{field:"gB"},"，可以推斷凶手是 ",{field:"gC"}," 的 ",{field:"gD"},"。" ] }
        ],
        orderInsensitivePairs:[{ a:"gA", b:"gB", accept:[["何文禮的新證詞","發票照片"]] }]
      },
      { type:"narrative", text:
`原來如此啊。
根據何文禮的說法，當天他和張大智兩個人都醉倒了，離開時根本沒辦法結帳。
然而，這張發票卻出現在案發現場，代表當天負責結帳的人在飯後又到了張大智的住處。
而這個人只有一個可能，就是何文禮的老婆。
你該不會，也知道她叫什麼名字吧？` },
      { type:"answer",
        fields:{
          gE:{ kind:"text",  accept:["許蕙萍"] }
        },
        rows:[
          { parts:["她的名字是 ",{field:"gE"},"。" ] }
        ],
      },
      { type:"narrative", text:
`我知道了。
等我的好消息吧。` },
      { type:"ending", text:"打開信封E" }
    ]
  },

  Truth:{
    id:"Truth", title:"Truth",
    steps:[
      { type:"narrative", text:
`寒暄的話就不多說了。
告訴我，解謎者。
在「哈卡克心理測驗」裡，到底還藏了什麼秘密？` },
      { type:"answer",
        fields:{
          h1:{ kind:"select",
               options:["心理測驗","心理測驗結果","何文禮的證詞","郭榮泰的證詞","莊曉純的證詞","林孟君的證詞","黃素娥的證詞","案發現場照片","桌面照片","死者手部照片","死者和前女友的合照","現場報告","解剖紀錄","報紙","鈔票照片","發票照片","手機支架照片","房東的新證詞","死者銀行紀錄","心理測驗原稿","回饋單1","回饋單2","回饋單3","回饋單4","回饋單5","林孟君聊天紀錄","何文禮聊天紀錄","郭榮泰聊天紀錄","莊曉純聊天紀錄","何文禮的新證詞","社團廣告單","許蕙萍自白","許蕙欣遺書","五年前的報紙"],
               accept:"心理測驗原稿" },
          h2:{ kind:"select",
               options:["心理測驗","心理測驗結果","何文禮的證詞","郭榮泰的證詞","莊曉純的證詞","林孟君的證詞","黃素娥的證詞","案發現場照片","桌面照片","死者手部照片","死者和前女友的合照","現場報告","解剖紀錄","報紙","鈔票照片","發票照片","手機支架照片","房東的新證詞","死者銀行紀錄","心理測驗原稿","回饋單1","回饋單2","回饋單3","回饋單4","回饋單5","林孟君聊天紀錄","何文禮聊天紀錄","郭榮泰聊天紀錄","莊曉純聊天紀錄","何文禮的新證詞","社團廣告單","許蕙萍自白","許蕙欣遺書","五年前的報紙"],
               accept:"社團廣告單" },
          h3:{ kind:"text",
               accept:[
                 "破碎的心","有裂痕的心","破掉的心","裂開的心","破裂的心","碎裂的心","碎掉的心",
                 "破碎的愛心","有裂痕的愛心","破掉的愛心","裂開的愛心","破裂的愛心","碎裂的愛心","碎掉的愛心",
                 "破碎的心臟","有裂痕的心臟","破掉的心臟","裂開的心臟","破裂的心臟","碎裂的心臟","碎掉的心臟"
               ] }
        },
        rows:[
          { parts:["如果按照 ",{field:"h1"}," 上的內容，可以在 ",{field:"h2"}," 上找出一個 ",{field:"h3"},"。"] }
        ]
      },
      { type:"narrative", text:
`「把破碎的心譜成一條線」。
不愧是才女，連死都死的這麼詩情畫意。
恭喜你，解謎者。
關於案件的謎團，已經全部都解開了。
但是，我還有最後一個考驗。
在一起經歷了這些之後，
親愛的解謎者，
你，
知道我是誰嗎？` },
      { type:"answer",
        fields:{ z:{ kind:"text", accept:"陳齊賢" } },
        rows:[ { parts:["你是 ",{field:"z"},"。"] } ]
      },
      { type:"ending", text:"打開信封F" }
    ]
  }
};
